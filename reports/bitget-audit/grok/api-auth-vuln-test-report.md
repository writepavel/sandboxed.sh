# Testing API Endpoints for Authentication Vulnerabilities\n\n## Executive Summary\n\nNo specific API endpoints, base URLs, or application context were provided in the mission. \n`/root/context/` is empty, and the working directory starts empty.\n\nThis report delivers a **complete guide** to testing APIs for authentication vulnerabilities, \nbased on OWASP API Security Top 10 (2023), PortSwigger Web Security Academy, and other authoritative sources.\n\nIncludes:\n- Common vulns\n- Step-by-step testing methodology\n- Manual curl examples\n- Recommended tools (installable here)\n- Mitigation strategies\n\n**Key Finding**: Without a target API, no specific vulns identified. Use this checklist for any API.\n\n## 1. Common Authentication Vulnerabilities\n\nFrom OWASP API Top 10 & sources:\n\n### A02:2023 - Broken Authentication (High Incidence)\n- Credential stuffing / brute-force (no rate limits)\n- Predictable tokens/sessions\n- Missing MFA/OTP\n- Weak password policies\n- Exposed creds in docs/logs\n\n### A01:2023 - Broken Object Level Authorization (BOLA/IDOR)\n- Change user ID in request to access others' data\n\n### A04:2023 - Broken Function Level Authorization\n- User accesses admin endpoints\n\n### Other:\n- Excessive data exposure post-auth\n- Mass assignment (update unintended fields)\n- Server-side request forgery via auth headers\n\n## 2. Testing Methodology (Checklist)\n\n### Phase 1: Reconnaissance\n1. Fetch OpenAPI/Swagger: `curl https://api.example.com/openapi.json`\n2. Fuzz endpoints: `ffuf -u https://api.example.com/FUZZ -w wordlist.txt`\n3. Identify auth methods (Basic, Bearer, API Key)\n\n### Phase 2: Authentication Tests\n1. **Unauthenticated access**: Hit protected endpoints without creds\n2. **Invalid creds/tokens**: 401? Or bypass?\n3. **Brute-force login**: Use `hydra` or `ffuf`\n4. **Token handling**: Replay old tokens, tamper JWT\n\n### Phase 3: Authorization Tests\n1. Login as low-priv user, test high-priv endpoints\n2. **IDOR**: `/users/123` â†’ `/users/456`\n3. Role escalation: Modify role in request body\n\n### Phase 4: Advanced\n1. Rate limiting bypass\n2. Session fixation\n3. CORS misconfig allowing auth bypass\n\n## 3. Manual Testing Examples (using curl + jq)\n\n**Hypothetical API**: `https://api.example.com/v1`\n\n### 3.1 Unauth Access\n```bash\ncurl -s -X GET \"https://api.example.com/v1/users\" | jq\n```\n**Vuln if**: Returns data (no 401)\n\n### 3.2 Login\n```bash\ncurl -s -X POST \"https://api.example.com/v1/auth/login\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"username\":\"admin\",\"password\":\"admin\"}' | jq '.token'\n```\nSave token: `TOKEN=$(curl ... | jq -r '.token')`\n\n### 3.3 Valid Auth\n```bash\ncurl -s -X GET \"https://api.example.com/v1/profile\" \\\n  -H \"Authorization: Bearer $TOKEN\" | jq\n```\n\n### 3.4 IDOR Test\n```bash\ncurl -s -X GET \"https://api.example.com/v1/users/1\" \\\n  -H \"Authorization: Bearer $LOW_PRIV_TOKEN\" | jq\n# Change to /users/2 (another user)\n```\n**Vuln if**: Returns other user's data\n\n### 3.5 Admin Bypass\n```bash\ncurl -s -X GET \"https://api.example.com/v1/admin/users\" \\\n  -H \"Authorization: Bearer $USER_TOKEN\"\n```\n**Vuln if**: 200 OK\n\n### 3.6 JWT Tamper (if JWT)\nUse jwt.io to decode, change claims, re-sign if weak secret.\n\n## 4. Automated Tools & Installation\n\n### OWASP ZAP (Recommended - Free DAST)\n```bash\napt install -y default-jdk wget\ncd /root/work/mission-ae0b2912/temp\nwget https://github.com/zaproxy/zaproxy/releases/download/v2.15.0/ZAP_2.15.0_Linux.tar.gz\ntar xzf ZAP_2.15.0_Linux.tar.gz\n# Run: ./zap.sh -cmd -quickurl https://target.com -quickout report.html\n```\n\n### Burp Suite Community\nDownload from portswigger.net\n\n### CLI Tools\n- **Nuclei**: `go install github.com/projectdiscovery/nuclei@latest`\n  Templates: nuclei -t cves/ -u https://target.com\n- **Ffuf**: `go install github.com/ffuf/ffuf@latest`\n\n## 5. Demo on Public Test API (httpbin.org)\n\nTest basic-auth endpoint:\n\n```bash\n# Valid\ncurl -u user:pass https://httpbin.org/basic-auth/user/pass\n\n# Invalid - expect 401\ncurl -u wrong:wrong https://httpbin.org/basic-auth/user/pass\n```\n\nNo vulns found (as expected).\n\n## 6. Mitigation Recommendations\n\n- **Auth**: OAuth2/JWT with short expiry, RS256 signing\n- **RBAC**: Server-side enforcement\n- **Rate limit**: 5 req/min per IP/user\n- **Validate IDs**: Check ownership\n- **HTTPS only**, HSTS\n- **Scan regularly** with ZAP/Postman\n\n## Next Steps\nProvide:\n- API base URL\n- OpenAPI spec\n- Sample creds/endpoints\n\nFor targeted testing.\n\n**Mission Deliverable**: Guide complete. Files in `/root/work/mission-ae0b2912/output/`